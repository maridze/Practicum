# Прогнозирование оттока клиентов оператора связи

## Описание проекта
Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.

**Описание услуг**

Оператор предоставляет два основных типа услуг: 

1. Стационарную телефонную связь. Возможно подключение телефонного аппарата к нескольким линиям одновременно.
2. Интернет. Подключение может быть двух типов: через телефонную линию (DSL*,* от англ. *digital subscriber line*, «цифровая абонентская линия») или оптоволоконный кабель (*Fiber optic*).

Также доступны такие услуги:

- Интернет-безопасность: антивирус (*DeviceProtection*) и блокировка небезопасных сайтов (*OnlineSecurity*);
- Выделенная линия технической поддержки (*TechSupport*);
- Облачное хранилище файлов для резервного копирования данных (*OnlineBackup*);
- Стриминговое телевидение (*StreamingTV*) и каталог фильмов (*StreamingMovies*).

За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года. Доступны различные способы расчёта и возможность получения электронного чека.

## Вывод
Был проведен EDA, в рамках которого я изучил все таблицы, распределения признаков и типы данных.

Затем я предобрабатывал данный в следующем порядке:
- Объединил все в один DataFrame.
- Заполнил пропуски в видах услуг, появившиеся после соединения.
- Добавил признак CLC(customer lifecycle) путем вычитания даты начала пользования услугами из даты окончания пользования услугами.
- Удалил данные с пропусками в TotalCharges (11 строк).
- Создал целевой признак Churn (0-клиент, 1-ушедший).
- Проверил корреляция признаков, т. к. она мешает обучению линейных моделей.

Далее я работал с выборками и создал:
- Тренировочная и тестовая выборки (75/25)
- Тренировочная и тестовая выборки с удаленными признаками с высокой корреляцией(TotalCharges, StreamingMovies, StreamingTV, InternetService) c типом кодировани OHE категориальных признаков и стандартизированными числовыми признаками(75/25)
- Тренировочная и тестовая выборки c типом кодировани OE категориальных признаков(75/25)

Потом я тестировал модели на кросс валидации:
- Логистическаяя регрессия с изменением C и penalty
- Catboost с изменением learning_rate, depth и l2_leaf_reg
- Случайный лес max_depth, min_samples_split, min_samples_leaf и n_estimators

Наилучшим образом себя показал Catboost, целевая метрика **ROC-AUG = 0.895**.
Проверка на тестовой выборке показала значение **ROC-AUG = 0.916**. Была изучена важность признаков и матрица ошибок.

**CatBoostClassifier** со следующими параметрами:
- iterations=300
- random_seed=250423
- cat_features=oe_features
- depth = 6
- l2_leaf_reg = 1
- learning_rate= 0.1